<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>日付と予約状態を表示するカレンダー</title>
<style>
    table {
        border-collapse: collapse;
        width: 300px;
        background-color: #00bb85;
    }
    th, td {
        padding: 5px;
        text-align: center;
    }
    .reserved {
        color: white;
    }
    .available {
        color: white;
    }
    .status {
        font-size: 12px;
        display: block;
        margin-top: 5px;
    }
    .status span {
        font-weight: bold;
    }
</style>
</head>
<body>

<h2 id="calendar-heading">カレンダー</h2>

<div id="calendar-buttons">
    <button onclick="previousMonth()">＜</button>
    <button onclick="nextMonth()">＞</button>
</div>
<div id="calendar-container">
    <table id="calendar-table">
        <thead>
            <tr id="calendar-header"></tr>
        </thead>
        <tbody id="calendar-body"></tbody>
    </table>
</div>

<script>
    var currentYear, currentMonth;
    var headerRow = document.getElementById('calendar-header');
    var body = document.getElementById('calendar-body');

    // 初期表示は今月のカレンダー
    var today = new Date();
    currentYear = today.getFullYear();
    currentMonth = today.getMonth();

    // 予約情報のサンプルデータ (日付をキーとした予約状態の配列)
    var reservations = {
        '2024-07-05': true,   // 2024年7月5日が予約済み
        '2024-07-15': false,  // 2024年7月15日が空いている
        '2024-07-20': true    // 2024年7月20日が予約済み
    };

    // カレンダーを表示する関数
    function showCalendar(year, month) {
        // ヘッダーの曜日を設定
        var days = ['日', '月', '火', '水', '木', '金', '土'];
        headerRow.innerHTML = '';
        days.forEach(function(day) {
            var th = document.createElement('th');
            th.textContent = day;
            headerRow.appendChild(th);
        });

        // カレンダーのボディを生成
        body.innerHTML = '';
        var startDate = new Date(year, month, 1);
        var endDate = new Date(year, month + 1, 0);
        var currentRow = document.createElement('tr');
        for (var i = 0; i < startDate.getDay(); i++) {
            currentRow.appendChild(document.createElement('td'));
        }
        for (var i = startDate.getDate(); i <= endDate.getDate(); i++) {
            var dateKey = year + '-' + (month + 1 < 10 ? '0' + (month + 1) : month + 1) + '-' + (i < 10 ? '0' + i : i);
            var reservationStatus = reservations[dateKey];

            var dayCell = document.createElement('td');

            // 日付をテキストとして表示
            var dateText = document.createElement('span');
            dateText.textContent = i;
            dayCell.appendChild(dateText);

            // 予約状態に応じて背景色を設定
            if (reservationStatus === true) {
                dayCell.classList.add('reserved');
            } else {
                dayCell.classList.add('available');
            }

            // ○×を表示する要素を追加
            var statusText = document.createElement('span');
            statusText.classList.add('status');
            if (reservationStatus === true) {
                statusText.innerHTML = '<span style="color: green;">○</span>';                
            } else {
				statusText.innerHTML = '<span style="color: red;">×</span>';

            }
            dayCell.appendChild(statusText);

            // 日付のdateKeyを保存する属性を追加
            dayCell.setAttribute('data-datekey', dateKey);

            // ボタンがクリックされたときの処理
            dayCell.addEventListener('click', function() {
                var selectedDate = this.getAttribute('data-datekey');
                alert('選択された日付: ' + selectedDate);
                // ここに他の処理を追加する（例: 予約処理など）
            });

            currentRow.appendChild(dayCell);

            if (currentRow.children.length % 7 == 0) {
                body.appendChild(currentRow);
                currentRow = document.createElement('tr');
            }
        }
        if (currentRow.children.length > 0) {
            body.appendChild(currentRow);
        }

        // カレンダーのタイトルを設定
        document.getElementById('calendar-heading').textContent = year + '年' + (month + 1) + '月';
    }

    // 初回表示
    showCalendar(currentYear, currentMonth);

    // 前の月へ移動する関数
    function previousMonth() {
		if (currentYear === today.getFullYear() && currentMonth === today.getMonth()) return; // 前の月には遷移不可
        currentMonth--;
        if (currentMonth < 0) {
            currentMonth = 11;
            currentYear--;
        }
        showCalendar(currentYear, currentMonth);
    }

    // 次の月へ移動する関数
    function nextMonth() {
		var maxDate = new Date(today.getFullYear(), today.getMonth() + 3, 0); // 先２カ月まで遷移可能
		if(new Date(currentYear, currentMonth + 1) > maxDate) return;
        currentMonth++;
        if (currentMonth > 11) {
            currentMonth = 0;
            currentYear++;
        }
        showCalendar(currentYear, currentMonth);
    }
</script>

</body>
</html>
